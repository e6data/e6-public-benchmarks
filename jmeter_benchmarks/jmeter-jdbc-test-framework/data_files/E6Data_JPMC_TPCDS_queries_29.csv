Query_Alias,Query
query-54-TPCDS-54-optimised,"with ss_items as (select i_item_id item_id     ,sum(ss_ext_sales_price) ss_item_rev  from store_sales   ,item   ,date_dim where ss_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and ss_sold_date_sk  = d_date_sk group by i_item_id), cs_items as (select i_item_id item_id     ,sum(cs_ext_sales_price) cs_item_rev  from catalog_sales    ,item    ,date_dim where cs_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and cs_sold_date_sk = d_date_sk group by i_item_id), ws_items as (select i_item_id item_id     ,sum(ws_ext_sales_price) ws_item_rev  from web_sales    ,item    ,date_dim where ws_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq =(select d_week_seq                    from date_dim                   where d_date = '1998-02-19'))  and ws_sold_date_sk  = d_date_sk group by i_item_id)  select ss_items.item_id    ,ss_item_rev    ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev    ,cs_item_rev    ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev    ,ws_item_rev    ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev    ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id  and ss_items.item_id=ws_items.item_id   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id     ,ss_item_rev limit 100"
query-9-TPCDS-9,"select i_item_id    ,i_item_desc    ,s_state    ,count(ss_quantity) as store_sales_quantitycount    ,avg(ss_quantity) as store_sales_quantityave    ,stddev_samp(ss_quantity) as store_sales_quantitystdev    ,stddev_samp(ss_quantity)/avg(ss_quantity) as store_sales_quantitycov    ,count(sr_return_quantity) as store_returns_quantitycount    ,avg(sr_return_quantity) as store_returns_quantityave    ,stddev_samp(sr_return_quantity) as store_returns_quantitystdev    ,stddev_samp(sr_return_quantity)/avg(sr_return_quantity) as store_returns_quantitycov    ,count(cs_quantity) as catalog_sales_quantitycount ,avg(cs_quantity) as catalog_sales_quantityave    ,stddev_samp(cs_quantity) as catalog_sales_quantitystdev    ,stddev_samp(cs_quantity)/avg(cs_quantity) as catalog_sales_quantitycov from store_sales   ,catalog_sales   ,store_returns   ,date_dim d1   ,date_dim d2   ,date_dim d3   ,store   ,item where d1.d_quarter_name = '1998Q1'  and d1.d_date_sk = ss_sold_date_sk  and i_item_sk = ss_item_sk  and s_store_sk = ss_store_sk  and ss_customer_sk = sr_customer_sk  and ss_item_sk = sr_item_sk  and ss_ticket_number = sr_ticket_number  and sr_returned_date_sk = d2.d_date_sk  and d2.d_quarter_name in ('1998Q1','1998Q2','1998Q3')  and sr_customer_sk = cs_bill_customer_sk  and sr_item_sk = cs_item_sk  and cs_sold_date_sk = d3.d_date_sk  and d3.d_quarter_name in ('1998Q1','1998Q2','1998Q3') group by i_item_id     ,i_item_desc     ,s_state order by i_item_id     ,i_item_desc     ,s_state limit 100"
query-15-TPCDS-15,"select i_product_name       ,i_brand       ,i_class       ,i_category       ,avg(inv_quantity_on_hand) qoh    from inventory      ,date_dim      ,item    where inv_date_sk=d_date_sk        and inv_item_sk=i_item_sk        and d_month_seq between 1212 and 1212 + 11    group by rollup(i_product_name            ,i_brand            ,i_class            ,i_category) order by qoh, i_product_name, i_brand, i_class, i_category limit 100"
query-27-TPCDS-27-optimised,"with ss as ( select      i_manufact_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_manufact_id in (select  i_manufact_id from item where i_category in ('Books')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), cs as ( select      i_manufact_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), ws as ( select      i_manufact_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_manufact_id)  select i_manufact_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_manufact_id order by total_sales limit 100"
query-18-TPCDS-18-optimised,"select  i_item_id ,i_item_desc ,s_store_id ,s_store_name ,sum(ss_net_profit) as store_sales_profit ,sum(sr_net_loss) as store_returns_loss ,sum(cs_net_profit) as catalog_sales_profit from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 4 and d1.d_year = 2000 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy        between 4 and 10 and d2.d_year       = 2000 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy        between 4 and 10  and d3.d_year       = 2000 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100"
query-22-TPCDS-22,"select     i_item_id   ,i_item_desc   ,s_store_id   ,s_store_name   ,sum(ss_quantity)    as store_sales_quantity   ,sum(sr_return_quantity) as store_returns_quantity   ,sum(cs_quantity)    as catalog_sales_quantity from   store_sales  ,store_returns  ,catalog_sales  ,date_dim       d1  ,date_dim       d2  ,date_dim       d3  ,store  ,item where   d1.d_moy        = 4  and d1.d_year       = 1999 and d1.d_date_sk      = ss_sold_date_sk and i_item_sk       = ss_item_sk and s_store_sk       = ss_store_sk and ss_customer_sk     = sr_customer_sk and ss_item_sk       = sr_item_sk and ss_ticket_number    = sr_ticket_number and sr_returned_date_sk  = d2.d_date_sk and d2.d_moy        between 4 and 4 + 3  and d2.d_year       = 1999 and sr_customer_sk     = cs_bill_customer_sk and sr_item_sk       = cs_item_sk and cs_sold_date_sk    = d3.d_date_sk    and d3.d_year       in (1999,1999+1,1999+2) group by   i_item_id  ,i_item_desc  ,s_store_id  ,s_store_name order by   i_item_id   ,i_item_desc  ,s_store_id  ,s_store_name limit 100"
query-28-TPCDS-28-optimised,"select c_last_name    ,c_first_name    ,c_salutation    ,c_preferred_cust_flag    ,ss_ticket_number    ,cnt from  (select ss_ticket_number      ,ss_customer_sk      ,count(*) cnt   from store_sales,date_dim,store,household_demographics   where store_sales.ss_sold_date_sk = date_dim.d_date_sk   and store_sales.ss_store_sk = store.s_store_sk    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk   and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)   and (household_demographics.hd_buy_potential = '>10000' or     household_demographics.hd_buy_potential = 'Unknown')   and household_demographics.hd_vehicle_count > 0   and (case when household_demographics.hd_vehicle_count > 0     then household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count     else null     end) > 1.2   and date_dim.d_year in (2000,2000+1,2000+2)   and store.s_county in ('Mobile County','Maverick County','Huron County','Kittitas County',              'Fairfield County','Jackson County','Barrow County','Pennington County')   group by ss_ticket_number,ss_customer_sk) dn,customer   where ss_customer_sk = c_customer_sk    and cnt between 15 and 20   order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number   limit 100"
query-57-TPCDS-57-optimised,"with ss as ( select      i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_item_id in (select  i_item_id from item where i_category in ('Children')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), cs as ( select      i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), ws as ( select      i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_item_id)  select   i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by i_item_id    ,total_sales limit 100"
query-63-TPCDS-63,"select     w_warehouse_name     ,w_warehouse_sq_ft     ,w_city     ,w_county     ,w_state     ,w_country     ,ship_carriers     ,""year""     ,sum(jan_sales) as jan_sales     ,sum(feb_sales) as feb_sales     ,sum(mar_sales) as mar_sales     ,sum(apr_sales) as apr_sales     ,sum(may_sales) as may_sales     ,sum(jun_sales) as jun_sales     ,sum(jul_sales) as jul_sales     ,sum(aug_sales) as aug_sales     ,sum(sep_sales) as sep_sales     ,sum(oct_sales) as oct_sales     ,sum(nov_sales) as nov_sales     ,sum(dec_sales) as dec_sales     ,sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot     ,sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot     ,sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot     ,sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot     ,sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot     ,sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot     ,sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot     ,sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot     ,sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot     ,sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot     ,sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot     ,sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot     ,sum(jan_net) as jan_net     ,sum(feb_net) as feb_net     ,sum(mar_net) as mar_net     ,sum(apr_net) as apr_net     ,sum(may_net) as may_net     ,sum(jun_net) as jun_net     ,sum(jul_net) as jul_net     ,sum(aug_net) as aug_net     ,sum(sep_net) as sep_net     ,sum(oct_net) as oct_net     ,sum(nov_net) as nov_net     ,sum(dec_net) as dec_net from (   select     w_warehouse_name     ,w_warehouse_sq_ft     ,w_city     ,w_county     ,w_state     ,w_country     ,'DIAMOND' || ',' || 'AIRBORNE' as ship_carriers    ,d_year as ""year""     ,sum(case when d_moy = 1         then ws_sales_price* ws_quantity else 0 end) as jan_sales     ,sum(case when d_moy = 2         then ws_sales_price* ws_quantity else 0 end) as feb_sales     ,sum(case when d_moy = 3         then ws_sales_price* ws_quantity else 0 end) as mar_sales     ,sum(case when d_moy = 4         then ws_sales_price* ws_quantity else 0 end) as apr_sales     ,sum(case when d_moy = 5         then ws_sales_price* ws_quantity else 0 end) as may_sales     ,sum(case when d_moy = 6         then ws_sales_price* ws_quantity else 0 end) as jun_sales     ,sum(case when d_moy = 7         then ws_sales_price* ws_quantity else 0 end) as jul_sales     ,sum(case when d_moy = 8         then ws_sales_price* ws_quantity else 0 end) as aug_sales     ,sum(case when d_moy = 9         then ws_sales_price* ws_quantity else 0 end) as sep_sales     ,sum(case when d_moy = 10         then ws_sales_price* ws_quantity else 0 end) as oct_sales     ,sum(case when d_moy = 11         then ws_sales_price* ws_quantity else 0 end) as nov_sales     ,sum(case when d_moy = 12         then ws_sales_price* ws_quantity else 0 end) as dec_sales     ,sum(case when d_moy = 1         then ws_net_paid_inc_tax * ws_quantity else 0 end) as jan_net     ,sum(case when d_moy = 2         then ws_net_paid_inc_tax * ws_quantity else 0 end) as feb_net     ,sum(case when d_moy = 3         then ws_net_paid_inc_tax * ws_quantity else 0 end) as mar_net     ,sum(case when d_moy = 4         then ws_net_paid_inc_tax * ws_quantity else 0 end) as apr_net     ,sum(case when d_moy = 5         then ws_net_paid_inc_tax * ws_quantity else 0 end) as may_net     ,sum(case when d_moy = 6         then ws_net_paid_inc_tax * ws_quantity else 0 end) as jun_net     ,sum(case when d_moy = 7         then ws_net_paid_inc_tax * ws_quantity else 0 end) as jul_net     ,sum(case when d_moy = 8         then ws_net_paid_inc_tax * ws_quantity else 0 end) as aug_net     ,sum(case when d_moy = 9         then ws_net_paid_inc_tax * ws_quantity else 0 end) as sep_net     ,sum(case when d_moy = 10         then ws_net_paid_inc_tax * ws_quantity else 0 end) as oct_net     ,sum(case when d_moy = 11         then ws_net_paid_inc_tax * ws_quantity else 0 end) as nov_net     ,sum(case when d_moy = 12         then ws_net_paid_inc_tax * ws_quantity else 0 end) as dec_net   from      web_sales     ,warehouse     ,date_dim     ,time_dim      ,ship_mode   where       ws_warehouse_sk = w_warehouse_sk     and ws_sold_date_sk = d_date_sk     and ws_sold_time_sk = t_time_sk     and ws_ship_mode_sk = sm_ship_mode_sk     and d_year = 2002     and t_time between 49530 and 49530+28800     and sm_carrier in ('DIAMOND','AIRBORNE')   group by     w_warehouse_name     ,w_warehouse_sq_ft     ,w_city     ,w_county     ,w_state     ,w_country    ,d_year union all   select     w_warehouse_name     ,w_warehouse_sq_ft     ,w_city     ,w_county     ,w_state     ,w_country     ,'DIAMOND' || ',' || 'AIRBORNE' as ship_carriers    ,d_year as ""year""     ,sum(case when d_moy = 1         then cs_ext_sales_price* cs_quantity else 0 end) as jan_sales     ,sum(case when d_moy = 2         then cs_ext_sales_price* cs_quantity else 0 end) as feb_sales     ,sum(case when d_moy = 3         then cs_ext_sales_price* cs_quantity else 0 end) as mar_sales     ,sum(case when d_moy = 4         then cs_ext_sales_price* cs_quantity else 0 end) as apr_sales     ,sum(case when d_moy = 5         then cs_ext_sales_price* cs_quantity else 0 end) as may_sales     ,sum(case when d_moy = 6         then cs_ext_sales_price* cs_quantity else 0 end) as jun_sales     ,sum(case when d_moy = 7         then cs_ext_sales_price* cs_quantity else 0 end) as jul_sales     ,sum(case when d_moy = 8         then cs_ext_sales_price* cs_quantity else 0 end) as aug_sales     ,sum(case when d_moy = 9         then cs_ext_sales_price* cs_quantity else 0 end) as sep_sales     ,sum(case when d_moy = 10         then cs_ext_sales_price* cs_quantity else 0 end) as oct_sales     ,sum(case when d_moy = 11         then cs_ext_sales_price* cs_quantity else 0 end) as nov_sales     ,sum(case when d_moy = 12         then cs_ext_sales_price* cs_quantity else 0 end) as dec_sales     ,sum(case when d_moy = 1         then cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as jan_net     ,sum(case when d_moy = 2         then cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as feb_net     ,sum(case when d_moy = 3         then cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as mar_net     ,sum(case when d_moy = 4         then cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as apr_net     ,sum(case when d_moy = 5         then cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as may_net     ,sum(case when d_moy = 6         then cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as jun_net     ,sum(case when d_moy = 7         then cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as jul_net     ,sum(case when d_moy = 8         then cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as aug_net     ,sum(case when d_moy = 9         then cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as sep_net     ,sum(case when d_moy = 10         then cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as oct_net     ,sum(case when d_moy = 11         then cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as nov_net     ,sum(case when d_moy = 12         then cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as dec_net   from      catalog_sales     ,warehouse     ,date_dim     ,time_dim      ,ship_mode   where       cs_warehouse_sk = w_warehouse_sk     and cs_sold_date_sk = d_date_sk     and cs_sold_time_sk = t_time_sk     and cs_ship_mode_sk = sm_ship_mode_sk     and d_year = 2002     and t_time between 49530 AND 49530+28800     and sm_carrier in ('DIAMOND','AIRBORNE')   group by     w_warehouse_name     ,w_warehouse_sq_ft     ,w_city     ,w_county     ,w_state     ,w_country    ,d_year ) x group by     w_warehouse_name     ,w_warehouse_sq_ft     ,w_city     ,w_county     ,w_state     ,w_country     ,ship_carriers    ,""year"" order by w_warehouse_name limit 100"
query-30-TPCDS-30,"select    sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin  ,i_category  ,i_class  ,grouping(i_category)+grouping(i_class) as lochierarchy  ,rank() over (     partition by grouping(i_category)+grouping(i_class),     case when grouping(i_class) = 0 then i_category end      order by sum(ss_net_profit)/sum(ss_ext_sales_price) asc) as rank_within_parent from   store_sales  ,date_dim    d1  ,item  ,store where   d1.d_year = 1999  and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk  and s_store_sk = ss_store_sk and s_state in ('SD','FL','MI','LA',         'MO','SC','AL','GA') group by rollup(i_category,i_class) order by  lochierarchy desc  ,case when lochierarchy = 0 then i_category end  ,rank_within_parent  limit 100"
query-44-TPCDS-44-optimised,"select channel, item, return_ratio, return_rank, currency_rank from (select 'web' as channel ,web.item ,web.return_ratio ,web.return_rank ,web.currency_rank from (     select      item     ,return_ratio     ,currency_ratio     ,rank() over (order by return_ratio) as return_rank     ,rank() over (order by currency_ratio) as currency_rank     from     (    select ws.ws_item_sk as item         ,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/         cast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio         ,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/         cast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio         from          web_sales ws left outer join web_returns wr              on (ws.ws_order_number = wr.wr_order_number and              ws.ws_item_sk = wr.wr_item_sk)         ,date_dim         where              wr.wr_return_amt > 10000              and ws.ws_net_profit > 1             and ws.ws_net_paid > 0             and ws.ws_quantity > 0             and ws_sold_date_sk = d_date_sk             and d_year = 2000             and d_moy = 12         group by ws.ws_item_sk     ) in_web ) web where  ( web.return_rank <= 10 or web.currency_rank <= 10 ) union select  'catalog' as channel ,catalog.item ,catalog.return_ratio ,catalog.return_rank ,catalog.currency_rank from (     select      item     ,return_ratio     ,currency_ratio     ,rank() over (order by return_ratio) as return_rank     ,rank() over (order by currency_ratio) as currency_rank     from     (    select          cs.cs_item_sk as item         ,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/         cast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio         ,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/         cast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio         from          catalog_sales cs left outer join catalog_returns cr             on (cs.cs_order_number = cr.cr_order_number and              cs.cs_item_sk = cr.cr_item_sk)         ,date_dim         where              cr.cr_return_amount > 10000              and cs.cs_net_profit > 1             and cs.cs_net_paid > 0             and cs.cs_quantity > 0             and cs_sold_date_sk = d_date_sk             and d_year = 2000             and d_moy = 12         group by cs.cs_item_sk     ) in_cat ) catalog where  ( catalog.return_rank <= 10 or catalog.currency_rank <=10 ) union select  'store' as channel ,store.item ,store.return_ratio ,store.return_rank ,store.currency_rank from (     select      item     ,return_ratio     ,currency_ratio     ,rank() over (order by return_ratio) as return_rank     ,rank() over (order by currency_ratio) as currency_rank     from     (    select sts.ss_item_sk as item         ,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio         ,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio         from          store_sales sts left outer join store_returns sr             on (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)         ,date_dim         where              sr.sr_return_amt > 10000              and sts.ss_net_profit > 1             and sts.ss_net_paid > 0              and sts.ss_quantity > 0             and ss_sold_date_sk = d_date_sk             and d_year = 2000             and d_moy = 12         group by sts.ss_item_sk     ) in_store ) store where ( store.return_rank <= 10 or  store.currency_rank <= 10 ) ) order by 1,4,5,2 limit 100"
query-75-TPCDS-75,"with ss as (select s_store_sk,     sum(ss_ext_sales_price) as sales,     sum(ss_net_profit) as profit from store_sales,    date_dim,    store where ss_sold_date_sk = d_date_sk    and d_date between cast('1998-08-04' as date)          and (cast('1998-08-04' as date) + interval 30 days)    and ss_store_sk = s_store_sk group by s_store_sk) , sr as (select s_store_sk,     sum(sr_return_amt) as ""returns"",     sum(sr_net_loss) as profit_loss from store_returns,    date_dim,    store where sr_returned_date_sk = d_date_sk    and d_date between cast('1998-08-04' as date)          and (cast('1998-08-04' as date) + interval 30 days)    and sr_store_sk = s_store_sk group by s_store_sk), cs as (select cs_call_center_sk,     sum(cs_ext_sales_price) as sales,     sum(cs_net_profit) as profit from catalog_sales,    date_dim where cs_sold_date_sk = d_date_sk    and d_date between cast('1998-08-04' as date)          and (cast('1998-08-04' as date) + interval 30 days) group by cs_call_center_sk ), cr as (select cr_call_center_sk,     sum(cr_return_amount) as ""returns"",     sum(cr_net_loss) as profit_loss from catalog_returns,    date_dim where cr_returned_date_sk = d_date_sk    and d_date between cast('1998-08-04' as date)          and (cast('1998-08-04' as date) + interval 30 days) group by cr_call_center_sk ), ws as ( select wp_web_page_sk,     sum(ws_ext_sales_price) as sales,     sum(ws_net_profit) as profit from web_sales,    date_dim,    web_page where ws_sold_date_sk = d_date_sk    and d_date between cast('1998-08-04' as date)          and (cast('1998-08-04' as date) + interval 30 days)    and ws_web_page_sk = wp_web_page_sk group by wp_web_page_sk), wr as (select wp_web_page_sk,     sum(wr_return_amt) as ""returns"",     sum(wr_net_loss) as profit_loss from web_returns,    date_dim,    web_page where wr_returned_date_sk = d_date_sk    and d_date between cast('1998-08-04' as date)          and (cast('1998-08-04' as date) + interval 30 days)    and wr_web_page_sk = wp_web_page_sk group by wp_web_page_sk)  select channel     , id     , sum(sales) as sales     , sum(""returns"") as ""returns""     , sum(profit) as profit from (select 'store channel' as channel     , ss.s_store_sk as id     , sales     , coalesce(""returns"", 0) as ""returns""     , (profit - coalesce(profit_loss,0)) as profit from  ss left join sr     on ss.s_store_sk = sr.s_store_sk union all select 'catalog channel' as channel     , cs_call_center_sk as id     , sales     , ""returns""     , (profit - profit_loss) as profit from cs    , cr union all select 'web channel' as channel     , ws.wp_web_page_sk as id     , sales     , coalesce(""returns"", 0) ""returns""     , (profit - coalesce(profit_loss,0)) as profit from  ws left join wr     on ws.wp_web_page_sk = wr.wp_web_page_sk ) x group by rollup (channel, id) order by channel     ,id limit 100"
query-82-TPCDS-82-optimised,"with sr_items as (select i_item_id item_id,     sum(sr_return_quantity) sr_item_qty from store_returns,    item,    date_dim where sr_item_sk = i_item_sk and  d_date  in     (select d_date     from date_dim     where d_week_seq in         (select d_week_seq         from date_dim      where d_date in ('1998-01-02','1998-10-15','1998-11-10'))) and  sr_returned_date_sk  = d_date_sk group by i_item_id), cr_items as (select i_item_id item_id,     sum(cr_return_quantity) cr_item_qty from catalog_returns,    item,    date_dim where cr_item_sk = i_item_sk and  d_date  in     (select d_date     from date_dim     where d_week_seq in         (select d_week_seq         from date_dim      where d_date in ('1998-01-02','1998-10-15','1998-11-10'))) and  cr_returned_date_sk  = d_date_sk group by i_item_id), wr_items as (select i_item_id item_id,     sum(wr_return_quantity) wr_item_qty from web_returns,    item,    date_dim where wr_item_sk = i_item_sk and  d_date  in     (select d_date     from date_dim     where d_week_seq in         (select d_week_seq         from date_dim         where d_date in ('1998-01-02','1998-10-15','1998-11-10'))) and  wr_returned_date_sk  = d_date_sk group by i_item_id)  select sr_items.item_id    ,sr_item_qty    ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev    ,cr_item_qty    ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev    ,wr_item_qty    ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev    ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items   ,cr_items   ,wr_items where sr_items.item_id=cr_items.item_id  and sr_items.item_id=wr_items.item_id order by sr_items.item_id     ,sr_item_qty limit 100"
query-4-TPCDS-4-optimised,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ws_ext_sales_price) as itemrevenue    ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over      (partition by i_class) as revenueratio from         web_sales       ,item       ,date_dim where     ws_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ws_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + INTERVAL 30 day) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
query-41-TPCDS-41-optimised,"select c_last_name    ,c_first_name    ,ca_city    ,bought_city    ,ss_ticket_number    ,amt,profit  from  (select ss_ticket_number      ,ss_customer_sk      ,ca_city bought_city      ,sum(ss_coupon_amt) amt      ,sum(ss_net_profit) profit   from store_sales,date_dim,store,household_demographics,customer_address   where store_sales.ss_sold_date_sk = date_dim.d_date_sk   and store_sales.ss_store_sk = store.s_store_sk    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk   and store_sales.ss_addr_sk = customer_address.ca_address_sk   and (household_demographics.hd_dep_count = 2 or     household_demographics.hd_vehicle_count= 1)   and date_dim.d_dow in (6,0)   and date_dim.d_year in (1998,1998+1,1998+2)   and store.s_city in ('Cedar Grove','Wildwood','Union','Salem','Highland Park')   group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr   where ss_customer_sk = c_customer_sk    and customer.c_current_addr_sk = current_addr.ca_address_sk    and current_addr.ca_city <> bought_city  order by c_last_name      ,c_first_name      ,ca_city      ,bought_city      ,ss_ticket_number  limit 100"
query-52-TPCDS-52-optimised,"with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where i_item_id in (select   i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8 group by i_item_id)  select i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by total_sales,      i_item_id limit 100"
query-69-TPCDS-69-optimised,"select i_brand_id brand_id, i_brand brand,t_hour,t_minute,     sum(ext_price) ext_price from item, (select ws_ext_sales_price as ext_price,             ws_sold_date_sk as sold_date_sk,             ws_item_sk as sold_item_sk,             ws_sold_time_sk as time_sk          from web_sales,date_dim         where d_date_sk = ws_sold_date_sk          and d_moy=12          and d_year=2000         union all         select cs_ext_sales_price as ext_price,             cs_sold_date_sk as sold_date_sk,             cs_item_sk as sold_item_sk,             cs_sold_time_sk as time_sk         from catalog_sales,date_dim         where d_date_sk = cs_sold_date_sk          and d_moy=12          and d_year=2000         union all         select ss_ext_sales_price as ext_price,             ss_sold_date_sk as sold_date_sk,             ss_item_sk as sold_item_sk,             ss_sold_time_sk as time_sk         from store_sales,date_dim         where d_date_sk = ss_sold_date_sk          and d_moy=12          and d_year=2000         ) tmp,time_dim where  sold_item_sk = i_item_sk  and i_manager_id=1  and time_sk = t_time_sk  and (t_meal_time = 'breakfast' or t_meal_time = 'dinner') group by i_brand, i_brand_id,t_hour,t_minute order by ext_price desc, i_brand_id "
query-35-TPCDS-35-optimised,"select   w_state  ,i_item_id  ,sum(case when (cast(d_date as date) < cast ('1998-04-08' as date))          then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before  ,sum(case when (cast(d_date as date) >= cast ('1998-04-08' as date))          then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after from  catalog_sales left outer join catalog_returns on    (cs_order_number = cr_order_number     and cs_item_sk = cr_item_sk)  ,warehouse  ,item  ,date_dim where   i_current_price between 0.99 and 1.49 and i_item_sk     = cs_item_sk and cs_warehouse_sk  = w_warehouse_sk  and cs_sold_date_sk  = d_date_sk and d_date between (cast ('1998-04-08' as date) - interval 30 day)         and (cast ('1998-04-08' as date) + interval 30 day) group by   w_state,i_item_id order by w_state,i_item_id limit 100"
query-13-TPCDS-13-optimised,"select i_item_id    ,i_item_desc     ,i_category     ,i_class     ,i_current_price    ,sum(cs_ext_sales_price) as itemrevenue     ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over      (partition by i_class) as revenueratio from    catalog_sales   ,item    ,date_dim where cs_item_sk = i_item_sk   and i_category in ('Jewelry', 'Sports', 'Books')  and cs_sold_date_sk = d_date_sk and d_date between cast('2001-01-12' as date)                  and (cast('2001-01-12' as date) + INTERVAL 30 day) group by i_item_id     ,i_item_desc      ,i_category     ,i_class     ,i_current_price order by i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
query-2-TPCDS-2,"select   cd_gender,  cd_marital_status,  cd_education_status,  count(*) cnt1,  cd_purchase_estimate,  count(*) cnt2,  cd_credit_rating,  count(*) cnt3,  cd_dep_count,  count(*) cnt4,  cd_dep_employed_count,  count(*) cnt5,  cd_dep_college_count,  count(*) cnt6 from  customer c,customer_address ca,customer_demographics where  c.c_current_addr_sk = ca.ca_address_sk and  ca_county in ('Walker County','Richland County','Gaines County','Douglas County','Dona Ana County') and  cd_demo_sk = c.c_current_cdemo_sk and  exists (select *      from store_sales,date_dim      where c.c_customer_sk = ss_customer_sk and         ss_sold_date_sk = d_date_sk and         d_year = 2002 and         d_moy between 4 and 4+3) and  (exists (select *       from web_sales,date_dim       where c.c_customer_sk = ws_bill_customer_sk and          ws_sold_date_sk = d_date_sk and          d_year = 2002 and          d_moy between 4 ANd 4+3) or   exists (select *       from catalog_sales,date_dim       where c.c_customer_sk = cs_ship_customer_sk and          cs_sold_date_sk = d_date_sk and          d_year = 2002 and          d_moy between 4 and 4+3)) group by cd_gender,      cd_marital_status,      cd_education_status,      cd_purchase_estimate,      cd_credit_rating,      cd_dep_count,      cd_dep_employed_count,      cd_dep_college_count order by cd_gender,      cd_marital_status,      cd_education_status,      cd_purchase_estimate,      cd_credit_rating,      cd_dep_count,      cd_dep_employed_count,      cd_dep_college_count limit 100"
query-50-TPCDS-50-optimised,"with my_customers as ( select distinct c_customer_sk     , c_current_addr_sk from      ( select cs_sold_date_sk sold_date_sk,         cs_bill_customer_sk customer_sk,         cs_item_sk item_sk      from  catalog_sales      union all      select ws_sold_date_sk sold_date_sk,         ws_bill_customer_sk customer_sk,         ws_item_sk item_sk      from  web_sales     ) cs_or_ws_sales,     item,     date_dim,     customer where  sold_date_sk = d_date_sk     and item_sk = i_item_sk     and i_category = 'Jewelry'     and i_class = 'consignment'     and c_customer_sk = cs_or_ws_sales.customer_sk     and d_moy = 3     and d_year = 1999 ) , my_revenue as ( select c_customer_sk,     sum(ss_ext_sales_price) as revenue from  my_customers,     store_sales,     customer_address,     store,     date_dim where c_current_addr_sk = ca_address_sk     and ca_county = s_county     and ca_state = s_state     and ss_sold_date_sk = d_date_sk     and c_customer_sk = ss_customer_sk     and d_month_seq between (select distinct d_month_seq+1                 from  date_dim where d_year = 1999 and d_moy = 3)              and (select distinct d_month_seq+3                 from  date_dim where d_year = 1999 and d_moy = 3) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment  from  my_revenue )  select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100"
query-7-TPCDS-7-optimised,"select ca_zip    ,sum(cs_sales_price) from catalog_sales   ,customer   ,customer_address   ,date_dim where cs_bill_customer_sk = c_customer_sk     and c_current_addr_sk = ca_address_sk      and ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475',                  '85392', '85460', '80348', '81792')        or ca_state in ('CA','WA','GA')        or cs_sales_price > 500)     and cs_sold_date_sk = d_date_sk     and d_qoy = 2 and d_year = 2000 group by ca_zip order by ca_zip limit 100"
query-58-TPCDS-58-optimised,"select promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100 from  (select sum(ss_ext_sales_price) promotions  from store_sales     ,store     ,promotion     ,date_dim     ,customer     ,customer_address     ,item  where ss_sold_date_sk = d_date_sk  and  ss_store_sk = s_store_sk  and  ss_promo_sk = p_promo_sk  and  ss_customer_sk= c_customer_sk  and  ca_address_sk = c_current_addr_sk  and  ss_item_sk = i_item_sk   and  ca_gmt_offset = -7  and  i_category = 'Books'  and  (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y')  and  s_gmt_offset = -7  and  d_year = 1999  and  d_moy = 11) promotional_sales,  (select sum(ss_ext_sales_price) total  from store_sales     ,store     ,date_dim     ,customer     ,customer_address     ,item  where ss_sold_date_sk = d_date_sk  and  ss_store_sk = s_store_sk  and  ss_customer_sk= c_customer_sk  and  ca_address_sk = c_current_addr_sk  and  ss_item_sk = i_item_sk  and  ca_gmt_offset = -7  and  i_category = 'Books'  and  s_gmt_offset = -7  and  d_year = 1999  and  d_moy = 11) all_sales order by promotions, total limit 100"
query-14-TPCDS-14-optimised,"select * from(select w_warehouse_name       ,i_item_id       ,sum(case when (cast(d_date as date) < cast ('1998-04-08' as date))             then inv_quantity_on_hand            else 0 end) as inv_before       ,sum(case when (cast(d_date as date) >= cast ('1998-04-08' as date))            then inv_quantity_on_hand            else 0 end) as inv_after  from inventory    ,warehouse    ,item    ,date_dim  where i_current_price between 0.99 and 1.49   and i_item_sk     = inv_item_sk   and inv_warehouse_sk  = w_warehouse_sk   and inv_date_sk  = d_date_sk   and d_date between (cast ('1998-04-08' as date) - INTERVAL 30 day)           and (cast ('1998-04-08' as date) + INTERVAL 30 day)  group by w_warehouse_name, i_item_id) x where (case when inv_before > 0       then inv_after / inv_before       else null       end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name     ,i_item_id limit 100"
query-66-TPCDS-66,"select   cd_gender,  cd_marital_status,  cd_education_status,  count(*) cnt1,  cd_purchase_estimate,  count(*) cnt2,  cd_credit_rating,  count(*) cnt3 from  customer c,customer_address ca,customer_demographics where  c.c_current_addr_sk = ca.ca_address_sk and  ca_state in ('CO','IL','MN') and  cd_demo_sk = c.c_current_cdemo_sk and  exists (select *      from store_sales,date_dim      where c.c_customer_sk = ss_customer_sk and         ss_sold_date_sk = d_date_sk and         d_year = 1999 and         d_moy between 1 and 1+2) and  (not exists (select *       from web_sales,date_dim       where c.c_customer_sk = ws_bill_customer_sk and          ws_sold_date_sk = d_date_sk and          d_year = 1999 and          d_moy between 1 and 1+2) and   not exists (select *       from catalog_sales,date_dim       where c.c_customer_sk = cs_ship_customer_sk and          cs_sold_date_sk = d_date_sk and          d_year = 1999 and          d_moy between 1 and 1+2)) group by cd_gender,      cd_marital_status,      cd_education_status,      cd_purchase_estimate,      cd_credit_rating order by cd_gender,      cd_marital_status,      cd_education_status,      cd_purchase_estimate,      cd_credit_rating limit 100"
query-98-TPCDS-98-optimised,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ss_ext_sales_price) as itemrevenue    ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over      (partition by i_class) as revenueratio from     store_sales       ,item       ,date_dim where     ss_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ss_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + interval 30 days) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio"
query-80-TPCDS-80,"with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk     ,ca_state as ctr_state,     sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns   ,date_dim   ,customer_address where cr_returned_date_sk = d_date_sk  and d_year =1998  and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk     ,ca_state )  select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name          ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset          ,ca_location_type,ctr_total_return from customer_total_return ctr1   ,customer_address   ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2              from customer_total_return ctr2               where ctr1.ctr_state = ctr2.ctr_state)    and ca_address_sk = c_current_addr_sk    and ca_state = 'IL'    and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name          ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset          ,ca_location_type,ctr_total_return limit 100"
query-65-TPCDS-65-optimised,"select c_last_name    ,c_first_name    ,ca_city    ,bought_city    ,ss_ticket_number    ,extended_price    ,extended_tax    ,list_price from (select ss_ticket_number       ,ss_customer_sk       ,ca_city bought_city       ,sum(ss_ext_sales_price) extended_price        ,sum(ss_ext_list_price) list_price       ,sum(ss_ext_tax) extended_tax     from store_sales      ,date_dim      ,store      ,household_demographics      ,customer_address     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and date_dim.d_dom between 1 and 2     and (household_demographics.hd_dep_count = 2 or       household_demographics.hd_vehicle_count= 1)     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_city in ('Cedar Grove','Wildwood')    group by ss_ticket_number        ,ss_customer_sk        ,ss_addr_sk,ca_city) dn    ,customer    ,customer_address current_addr where ss_customer_sk = c_customer_sk  and customer.c_current_addr_sk = current_addr.ca_address_sk  and current_addr.ca_city <> bought_city order by c_last_name     ,ss_ticket_number limit 100"
query-88-TPCDS-88-optimised,"select * from( select i_category, i_class, i_brand,    s_store_name, s_company_name,    d_moy,    sum(ss_sales_price) sum_sales,    avg(sum(ss_sales_price)) over     (partition by i_category, i_brand, s_store_name, s_company_name)     avg_monthly_sales from store_sales, item, date_dim, store where ss_item_sk = i_item_sk and    ss_sold_date_sk = d_date_sk and    ss_store_sk = s_store_sk and    d_year in (2000) and     ((i_category in ('Home','Books','Electronics') and      i_class in ('wallpaper','parenting','musical')     )    or (i_category in ('Shoes','Jewelry','Men') and      i_class in ('womens','birdal','pants')     )) group by i_category, i_class, i_brand,     s_store_name, s_company_name, d_moy) tmp1 where case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1 order by sum_sales - avg_monthly_sales, s_store_name limit 100"
